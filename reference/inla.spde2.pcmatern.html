<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Matern SPDE model object with PC prior for INLA — inla.spde2.pcmatern • inlamesh3d</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Matern SPDE model object with PC prior for INLA — inla.spde2.pcmatern"><meta property="og:description" content="Create an inla.spde2 model object for a Matern model, using a PC
prior for the parameters.
This method constructs a Matern SPDE model, with spatial range \(\rho\)
and standard deviation parameter \(\sigma\).  In the parameterisation
$$(\kappa^2-\Delta)^{\alpha/2}(\tau $$$$ x(u))=W(u)$$
the spatial scale parameter \(\kappa=\sqrt{8\nu}/\rho\), where
\(\nu=\alpha-d/2\), and \(\tau\) is proportional to \(1/\sigma\).
Stationary models are supported for \(0 &amp;lt; \alpha \leq 2\),
with spectral approximation methods used for non-integer \(\alpha\), with
approximation method determined by fractional.method.
Integration and other general linear constraints are supported via the
constr, extraconstr.int, and extraconstr parameters,
which also interact with n.iid.group."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">inlamesh3d</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.0.0.9001</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../articles/spde3d.html">SPDE models on 3D meshes</a>
    </li>
  </ul></li>
      </ul><ul class="nav navbar-nav navbar-right"></ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Matern SPDE model object with PC prior for INLA</h1>
    
    <div class="hidden name"><code>inla.spde2.pcmatern.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Create an <code>inla.spde2</code> model object for a Matern model, using a PC
prior for the parameters.</p>
<p>This method constructs a Matern SPDE model, with spatial range \(\rho\)
and standard deviation parameter \(\sigma\).  In the parameterisation</p>
<p>$$(\kappa^2-\Delta)^{\alpha/2}(\tau $$$$ x(u))=W(u)$$</p>
<p>the spatial scale parameter \(\kappa=\sqrt{8\nu}/\rho\), where
\(\nu=\alpha-d/2\), and \(\tau\) is proportional to \(1/\sigma\).</p>
<p>Stationary models are supported for \(0 &lt; \alpha \leq 2\),
with spectral approximation methods used for non-integer \(\alpha\), with
approximation method determined by <code>fractional.method</code>.</p>
<p>Integration and other general linear constraints are supported via the
<code>constr</code>, <code>extraconstr.int</code>, and <code>extraconstr</code> parameters,
which also interact with <code>n.iid.group</code>.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">inla.spde2.pcmatern</span><span class="op">(</span><span class="va">mesh</span>, <span class="va">...</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S3 method for inla_mesh_3d</span></span>
<span><span class="fu">inla.spde2.pcmatern</span><span class="op">(</span><span class="va">mesh</span>, <span class="va">...</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S3 method for default</span></span>
<span><span class="fu">inla.spde2.pcmatern</span><span class="op">(</span><span class="va">mesh</span>, <span class="va">...</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">inla.spde2.pcmatern3d</span><span class="op">(</span></span>
<span>  <span class="va">mesh</span>,</span>
<span>  alpha <span class="op">=</span> <span class="fl">2</span>,</span>
<span>  param <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  constr <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  extraconstr.int <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  extraconstr <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  fractional.method <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"parsimonious"</span>, <span class="st">"null"</span><span class="op">)</span>,</span>
<span>  n.iid.group <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  prior.range <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  prior.sigma <span class="op">=</span> <span class="cn">NULL</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>mesh</dt>
<dd><p>The mesh to build the model on, as an <code><a href="https://rdrr.io/pkg/INLA/man/inla.mesh.create.html" class="external-link">inla.mesh()</a></code> or
<code><a href="https://rdrr.io/pkg/INLA/man/inla.mesh.1d.html" class="external-link">inla.mesh.1d()</a></code> object.</p></dd>


<dt>alpha</dt>
<dd><p>Fractional operator order, \(0&lt;\alpha\leq 2\)
supported, for \(\nu=\alpha-d/2&gt;0\).</p></dd>


<dt>param</dt>
<dd><p>Further model parameters. Not currently used.</p></dd>


<dt>constr</dt>
<dd><p>If <code>TRUE</code>, apply an integrate-to-zero constraint.
Default <code>FALSE</code>.</p></dd>


<dt>extraconstr.int</dt>
<dd><p>Field integral constraints.</p></dd>


<dt>extraconstr</dt>
<dd><p>Direct linear combination constraints on the basis
weights.</p></dd>


<dt>fractional.method</dt>
<dd><p>Specifies the approximation method to use for
fractional (non-integer) <code>alpha</code> values. <code>'parsimonious'</code> gives an
overall approximate minimal covariance error, <code>'null'</code> uses
approximates low-order properties.</p></dd>


<dt>n.iid.group</dt>
<dd><p>If greater than 1, build an explicitly iid replicated
model, to support constraints applied to the combined replicates, for
example in a time-replicated spatial model. Constraints can either be
specified for a single mesh, in which case it's applied to the average of
the replicates (<code>ncol(A)</code> should be <code>mesh$n</code> for 2D meshes,
<code>mesh$m</code> for 1D), or as general constraints on the collection of
replicates (<code>ncol(A)</code> should be <code>mesh$n * n.iid.group</code> for 2D
meshes, <code>mesh$m * n.iid.group</code> for 1D).</p></dd>


<dt>prior.range</dt>
<dd><p>A length 2 vector, with <code>(range0,Prange)</code> specifying
that \(P(\rho &lt; \rho_0)=p_\rho\), where \(\rho\) is the spatial range of
the random field. If <code>Prange</code> is <code>NA</code>, then <code>range0</code> is used
as a fixed range value.</p></dd>


<dt>prior.sigma</dt>
<dd><p>A length 2 vector, with <code>(sigma0,Psigma)</code> specifying
that \(P(\sigma &gt; \sigma_0)=p_\sigma\), where \(\sigma\) is the marginal
standard deviation of the field.  If <code>Psigma</code> is <code>NA</code>, then
<code>sigma0</code> is used as a fixed range value.</p></dd>

</dl></div>
    <div id="value">
    <h2>Value</h2>
    

<p>An <code>inla.spde2</code> object.</p>
    </div>
    <div id="details">
    <h2>Details</h2>
    <p>The joint PC prior density for the spatial range, \(\rho\), and the
marginal standard deviation, \(\sigma\), and is $$ $$$$ \pi(\rho,
\sigma) = $$$$ \frac{d \lambda_\rho}{2} \rho^{-1-d/2} \exp(-\lambda_\rho
\rho^{-d/2}) $$$$ \lambda_\sigma\exp(-\lambda_\sigma \sigma) $$ where
\(\lambda_\rho\) and \(\lambda_\sigma\) are hyperparameters that
must be determined by the analyst. The practical approach for this in INLA
is to require the user to indirectly specify these hyperparameters through
$$P(\rho &lt; \rho_0) = p_\rho$$ and $$P(\sigma &gt; \sigma_0) = p_\sigma$$
where the user specifies the lower tail quantile and probability for the
range (\(\rho_0\) and \(p_\rho\)) and the upper tail quantile and
probability for the standard deviation (\(\sigma_0\) and
\(\alpha_\sigma\)).</p>
<p>This allows the user to control the priors of the parameters by supplying
knowledge of the scale of the problem. What is a reasonable upper magnitude
for the spatial effect and what is a reasonable lower scale at which the
spatial effect can operate? The shape of the prior was derived through a
construction that shrinks the spatial effect towards a base model of no
spatial effect in the sense of distance measured by Kullback-Leibler
divergence.</p>
<p>The prior is constructed in two steps, under the idea that having a spatial
field is an extension of not having a spatial field. First, a spatially
constant random effect (\(\rho = \infty\)) with finite variance is more
complex than not having a random effect (\(\sigma = 0\)). Second, a
spatial field with spatial variation (\(\rho &lt; \infty\)) is more complex
than the random effect with no spatial variation. Each of these extensions
are shrunk towards the simpler model and, as a result, we shrink the spatial
field towards the base model of no spatial variation and zero variance
(\(\rho = \infty\) and \(\sigma = 0\)).</p>
<p>The details behind the construction of the prior is presented in Fuglstad,
et al. (2016) and is based on the PC prior framework (Simpson, et al.,
2015).</p>
    </div>
    <div id="references">
    <h2>References</h2>
    <p>Fuglstad, G.-A., Simpson, D., Lindgren, F., and Rue, H. (2016)
Constructing Priors that Penalize the Complexity of Gaussian Random Fields.
arXiv:1503.00256</p>
<p>Simpson, D., Rue, H., Martins, T., Riebler, A., and Sørbye, S. (2015)
Penalising model component complexity: A principled, practical approach to
constructing priors. arXiv:1403.4630</p>
    </div>
    <div id="see-also">
    <h2>See also</h2>
    <div class="dont-index"><p><code><a href="https://rdrr.io/pkg/INLA/man/inla.mesh.2d.html" class="external-link">inla.mesh.2d()</a></code>, <code><a href="https://rdrr.io/pkg/INLA/man/inla.mesh.create.html" class="external-link">inla.mesh.create()</a></code>,
<code><a href="https://rdrr.io/pkg/INLA/man/inla.mesh.1d.html" class="external-link">inla.mesh.1d()</a></code>, <code><a href="https://rdrr.io/pkg/INLA/man/inla.mesh.basis.html" class="external-link">inla.mesh.basis()</a></code>,
<code><a href="inla.spde2.matern.html">inla.spde2.matern()</a></code>, <code><a href="https://rdrr.io/pkg/INLA/man/inla.spde2.generic.html" class="external-link">inla.spde2.generic()</a></code></p></div>
    </div>
    <div id="author">
    <h2>Author</h2>
    <p>Finn Lindgren <a href="mailto:finn.lindgren@gmail.com">finn.lindgren@gmail.com</a></p>
    </div>

  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Finn Lindgren.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

      </footer></div>

  


  

  </body></html>

